<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="A discussion of the the effects of genetic drift. The page includes a simulator for charting different genetic drift scenarios."
    />
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
    <link rel="manifest" href="site.webmanifest" />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
    <title>Genetic Drift</title>
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://d3js.org/d3.v6.min.js" defer></script>
    <script src="js/helper-functions.js" defer></script>
    <script src="js/genetic-drift.js" defer></script>
    <script src="js/draw-line-chart.js" defer></script>
  </head>

  <body>
    <div class="container">
      <main>
        <article>
          <header class="page-header">
            <h1 class="page-title">Genetic Drift: Random Sampling</h1>
            <p>
              The Hardy-Weinberg Equilibrium Model describes a hypothetical
              world where allele frequencies remain constant over time, i.e. one
              in which evolution does not take place. One of the assumptions of
              the model is an infinite population size. If this assumption is
              dropped, evolution becomes possible via the mechanism of genetic
              drift.
            </p>
          </header>

          <!-- GENETIC DRIFT -->
          <section>
            <h2>Genetic Drift</h2>
            <p>
              Genetic drift is the random sampling of alleles in a population.
              That is to say, the frequency of a particular allele in relation
              to its counterpart is not determined by natural selection, but by
              chance.
            </p>

            <p>In population genetics,</p>
            <ul>
              <li>
                <strong>evolution</strong> is defined as as the change in allele
                frequencies in a population over generations. Two evolutionary
                mechanisms are:
                <ul>
                  <li>
                    <strong>natural selection</strong>, defined Â as the change
                    in allele frequencies in a population over generations
                    <em>as a result of their fitness for reproduction</em>.
                  </li>
                  <li>
                    <strong>genetic drift</strong>, defined as the change in
                    allele frequencies in a population over generations
                    <em>due to random sampling</em>, leading to loss of genetic
                    variation.
                  </li>
                </ul>
              </li>
            </ul>
            <p>
              Genetic drift occurs in all non-infinite populations, but its
              effects are more clearly apparent in small populations. The
              'drift' in genetic drift can be explained most easily with an
              example:
            </p>
            <p>
              Given two alleles of a gene coding for fur colour,
              <span class="dominant">B</span> and
              <span class="recessive">b</span>, either may move (drift) towards:
            </p>
            <ul class="no-bullets">
              <li>
                <strong>Fixation</strong> &mdash; only
                <span class="dominant">B</span> survives (or vice-versa).
              </li>
              <li>
                <strong>Loss</strong> &mdash;
                <span class="recessive">b</span> becomes extinct (or
                vice-versa).
              </li>
            </ul>
            <p>
              To reiterate: whichever allele drifts to fixation or loss is a
              matter of chance, not of natural selection. The surviving allele
              could be detrimental or beneficial (or neither) towards the
              adaptability of the phenotype to its environment.
            </p>
          </section>

          <section>
            <h2>Causes</h2>
            <p>
              As mentioned, genetic drift occurs most markedly in small
              populations. The events that produce small populations are of two
              main kinds:
            </p>
            <h3>1) The Bottleneck Effect</h3>
            <p>
              Some kind of catastrophic event occurs, killing off a large
              percentage of a population. Subsequent generations will have a
              much smaller allele pool to draw from, and chance events (e.g.
              reproductory success) can lead to the disappearance of a
              particular allele from the population within a few generations.
            </p>
            <h3>2) The Founder effect</h3>
            <p>
              A small part of a population breaks off from the main body and
              becomes isolated from it. The frequencies of the alleles in this
              much reduced allele pool will now be subject to chance and, as in
              the bottleneck effect, their drift towards fixation or loss in
              subsequent generations will become more likely.
            </p>
          </section>
          <section>
            <h2>An Example</h2>
            <h3>Generation One (following a bottleneck or founder effect)</h3>
            <p>A small population of ten rabbits is made up of:</p>
            <ul>
              <li>
                eight individuals with black fur (genotype
                <span class="dominant">BB</span> or
                <span class="dominant">B</span><span class="recessive">b</span>)
                and
              </li>
              <li>
                two individuals with brown fur (genotype
                <span class="recessive">bb</span>).
              </li>
            </ul>
            <ul class="no-bullets">
              <li>
                <span class="strong-special">P</span> (<span class="dominant"
                  >B</span
                >
                allele frequency) &equals; 0.5
              </li>
              <li>
                <span class="strong-special">q</span> (<span class="recessive"
                  >b</span
                >
                allele frequency) &equals; 0.5
              </li>
            </ul>
            <img
              src="img/generation-1.png"
              alt="Generation one: five out of ten rabbits (BB, BB, Bb, Bb, Bb) reproduce."
            />
            <p>Five rabbits (outlined in red) reproduce.</p>

            <h3>Generation 2</h3>
            <p>The population is now made up of:</p>
            <ul>
              <li>
                nine individuals with black fur (genotype
                <span class="dominant">BB</span> or
                <span class="dominant">B</span><span class="recessive">b</span>)
                and
              </li>
              <li>
                one individual with brown fur (genotype
                <span class="recessive">bb</span>).
              </li>
            </ul>
            <ul class="no-bullets">
              <li>
                <span class="strong-special">P</span> (<span class="dominant"
                  >B</span
                >
                allele frequency) &equals; 0.7
              </li>
              <li>
                <span class="strong-special">q</span> (<span class="recessive"
                  >b</span
                >
                allele frequency) &equals; 0.3
              </li>
            </ul>
            <img
              src="img/generation-2.png"
              alt="Generation two: two out of ten rabbits (BB, BB) reproduce."
            />
            <p>Two rabbits reproduce.</p>

            <h3>Generation 3</h3>
            <p>The population is now made up of:</p>
            <ul>
              <li>
                ten individuals with black fur (genotype
                <span class="dominant">BB</span> or
                <span class="dominant">B</span><span class="recessive">b</span>)
                and
              </li>
              <li>
                zero individuals with brown fur (genotype
                <span class="recessive">bb</span>).
              </li>
            </ul>

            <ul class="no-bullets">
              <li>
                <span class="strong-special">P</span> (<span class="dominant"
                  >B</span
                >
                allele frequency) &equals; 1
              </li>
              <li>
                <span class="strong-special">q</span> (<span class="recessive"
                  >b</span
                >
                allele frequency) &equals; 0
              </li>
            </ul>
            <img
              src="img/generation-3.png"
              alt="Generation three: all ten rabbits are now of genotype BB."
            />

            <p>
              The gene for brown fur (<span class="recessive">bb</span>) has
              disappeared (drifted to loss) in only three generations.
            </p>
            <p>
              The fact that five rabbits reproduced in the first generation and
              only two reproduced in the second was purely a matter of chance.
            </p>
            <p>
              However, if the first generation population had been much larger,
              say a thousand rabbits rather than ten, there would have initially
              been two hundred rabbits with the
              <span class="recessive">bb</span> genotype rather than two, and
              the likelihood that none of these rabbits would have passed on
              their genes to the third generation would have been much smaller.
            </p>
            <p>
              The drift towards the fixation or loss of alleles in small
              populations reflects the law of large numbers.
            </p>
          </section>

          <section>
            <h3>The law of large numbers</h3>
            <p>
              The law of large numbers states that in the long run random events
              tend to average out at the expected value.
            </p>

            <h4>Example: tossing a coin</h4>
            <p>
              There are two sides to a coin so the probability of heads landing
              is 50&percnt; and the probability of tails landing is also
              50&percnt;. The expected value is therefore 0.5.
            </p>
            <p>
              However, if we tossed the coin only ten times, we wouldn't be
              surprised if heads landed 70&percnt; of the time and tails
              30&percnt; of the time, or even 100&percnt; and 0&percnt; of the
              time.
            </p>
            <p>
              On the other hand, if we tossed the coin a million times, we would
              be very surprised if we obtained these ranges of values. It is
              much more likely that the result would be very close to 50&percnt;
              for either side, i.e. close to the expected value of 0.5. (As up
              to ten simulations can be run at the same time, drifting to both
              fixation and loss may be seen as possible outcomes in the same
              chart.)
            </p>

            <form id="number-coin-tosses">
              <label for="selectNumber"
                >Choose number of coin tosses:
                <select id="selectNumber">
                  <option value="1">1</option>
                  <option value="10">10</option>
                  <option value="100">100</option>
                  <option value="1000">1,000</option>
                  <option value="10000">10,000</option>
                  <option value="100000">100,000</option>
                  <option value="1000000">1,000,000</option>
                </select>
              </label>
              <p>
                You can keep clicking the button at the selected value to see
                variations.
              </p>
              <div class="form-buttons">
                <button id="showCoinResultsBtn">Show Results</button>
                <button id="clearCoinResultsBtn" class="clear-results-btn hide">
                  Clear chart
                </button>
              </div>
            </form>

            <div id="results" class="results hide">
              <p>Out of <span id="numCoinTosses"></span> coin tosses:</p>
              <table>
                <tbody>
                  <tr>
                    <td></td>
                    <th scope="col">Value</th>
                    <th scope="col">&percnt;</th>
                  </tr>
                  <tr>
                    <th scope="row">Heads</th>
                    <td id="numHeads"></td>
                    <td id="headsPercent"></td>
                  </tr>
                  <tr>
                    <th scope="row">Tails</th>
                    <td id="numTails"></td>
                    <td id="tailsPercent"></td>
                  </tr>
                </tbody>
              </table>
            </div>

            <p>
              Returning to the earlier example, if the rabbit population size
              had been made up of hundreds of thousands of individuals, instead
              of only ten, the initial frequencies of 0.5 for the
              <span class="strong-special">P</span> (<span class="dominant"
                >B</span
              >
              allele) and <span class="strong-special">q</span> (<span
                class="recessive"
                >b</span
              >
              allele) would have shown little variation over many generations.
            </p>
          </section>

          <section>
            <h2>Simulating Genetic Drift</h2>
            <p>
              The charts simulate the possible frequencies of one allele,
              <span class="dominant">B</span>, having an initial frequency of
              0.5, over a selected number of generations at different population
              sizes. Allele <span class="dominant">B</span>'s corresponding
              allele, <span class="recessive">b</span>, is not shown but its
              fate can be inferred from the results:
            </p>
            <ul>
              <li>
                If the line goes to the top of the x-axis (1.0) and flattens
                out,
                <span class="dominant">B</span> has drifted to fixation (it is
                the only surviving allele) and
                <span class="recessive">b</span> has drifted to loss (it has
                gone extinct),
              </li>
              <li>
                If the line goes to the bottom of the x-axis (0.0) and flattens
                out,
                <span class="dominant">B</span> has drifted to loss and
                <span class="recessive">b</span> has drifted to fixation.
              </li>
            </ul>

            <form id="chartInputForm">
              <div class="chart-selections">
                <!-- number of simulations-->
                <label for="selectNumSimulations"
                  >No. simulations:
                  <select id="selectNumSimulations">
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10" selected="selected">10</option>
                  </select>
                </label>
                <!-- end number of simulations -->
                <label for="selectPopulationSize"
                  >Population size:
                  <select id="selectPopulationSize">
                    <option value="20" selected="selected">20</option>
                    <option value="200">200</option>
                    <option value="2000">2,000</option>
                  </select>
                </label>
                <label for="selectNumberGenerations"
                  >No. generations:
                  <select id="selectNumberGenerations">
                    <option value="50" selected="selected">50</option>
                    <option value="100">100</option>
                    <option value="200">200</option>
                    <option value="400">400</option>
                    <option value="700">700</option>
                  </select>
                </label>
              </div>
              <p>
                You can keep clicking the button at the selected values to see
                variations.
              </p>
              <div class="form-buttons">
                <button id="showChartResultsBtn">Show Chart</button>
                <button
                  id="clearChartResultsBtn"
                  class="clear-results-btn hide"
                >
                  Clear chart
                </button>
              </div>
            </form>

            <div id="chartContainer" class="chart-container show">
              <h3 id="chartTitle" class="chart-title hide">
                No. simulations: <span id="numSimulationsTxt"></span> |
                Population size: <span id="populationSize"></span> | No.
                generations:
                <span id="numGenerations"></span>
              </h3>
              <div id="chart_loading" class="chart-loading"></div>
              <div id="chart" class="chart"></div>
            </div>

            <h3>Sample Results</h3>

            <p>
              Below are three screenshots of charts showing ten simulations with
              different population sizes, over fifty generations.
            </p>
            <div class="chart-screenshot">
              <h4 class="chart-screenshot-heading">Population: 20</h4>
              <figure>
                <img
                  src="img/chart-20.png"
                  alt="Screenshot of chart: Number of simulations: 10, Generations: 50, Population: 20"
                />
                <figcaption>
                  In a small population, the
                  <span class="dominant">B</span> allele rapidly drifts to
                  fixation or loss.
                </figcaption>
              </figure>
            </div>
            <div class="chart-screenshot">
              <h4 class="chart-screenshot-heading">Population: 200</h4>
              <figure>
                <img
                  src="img/chart-200.png"
                  alt="Screenshot of chart: Number of simulations: 10, Generations: 50, Population: 200"
                />
                <figcaption>
                  In a medium-sized population there are already no instances of
                  drift towards fixation or loss.
                </figcaption>
              </figure>
            </div>
            <div class="chart-screenshot">
              <h4 class="chart-screenshot-heading">Population: 2000</h4>
              <figure>
                <img
                  src="img/chart-2000.png"
                  alt="Screenshot of chart: Number of simulations: 10, Generations: 50, Population: 200"
                />
                <figcaption>
                  In a large population the allele frequency is tending towards
                  the expected value of 0.5.
                </figcaption>
              </figure>
            </div>
          </section>
        </article>
      </main>
      <footer class="page-footer">
        <nav>
          <ul class="no-bullets page-footer-nav">
            <li class="previous">
              <a
                href="https://chrisnajman.github.io/hardy-weinberg-equilibrium-model/"
                >&#9668; Previous: Hardy-Weinberg Equilibrium Model</a
              >
            </li>
            <!-- 
            <li class="next">
              <a href="https://chrisnajman.github.io/[]/"
                >Next:[]
                &#9658;</a
              >
            </li>
             -->
          </ul>
        </nav>
      </footer>
    </div>
  </body>
</html>
